
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Trip Planner - Plan Your Perfect Journey</title>
    <meta name="description" content="Craft the perfect journey with intelligent planning powered by AI" />
    <meta name="author" content="Lovable" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        :root {
            --primary: 222.2 47.4% 11.2%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96.1%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 222.2 84% 4.9%;
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --radius: 0.5rem;
        }

        [data-theme="dark"] {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --popover: 222.2 84% 4.9%;
            --popover-foreground: 210 40% 98%;
            --primary: 210 40% 98%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 212.7 26.8% 83.9%;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            line-height: 1.5;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .min-h-screen {
            min-height: 100vh;
        }

        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .fixed {
            position: fixed;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 4rem 0 6rem;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 40% 80%, rgba(120, 119, 198, 0.2) 0%, transparent 50%);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(1deg); }
        }

        .hero-content {
            text-align: center;
            position: relative;
            z-index: 10;
            color: white;
        }

        .hero-title {
            font-family: 'Poppins', sans-serif;
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, #ffffff, #e0e7ff, #c7d2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: slideInDown 1s ease-out;
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            opacity: 0.95;
            margin-bottom: 2rem;
            animation: slideInUp 1s ease-out 0.3s both;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Main Content */
        .main-content {
            margin-top: -3rem;
            position: relative;
            z-index: 20;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .card {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
        }

        .card-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: hsl(var(--foreground));
            margin: 0;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.75rem;
            color: hsl(var(--foreground));
            font-size: 0.95rem;
        }

        .form-textarea {
            width: 100%;
            min-height: 140px;
            padding: 1rem;
            border: 2px solid hsl(var(--input));
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            transition: all 0.3s ease;
            resize: vertical;
        }

        .form-textarea:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 3px hsla(var(--ring), 0.2);
        }

        .form-textarea::placeholder {
            color: hsl(var(--muted-foreground));
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-family: 'Inter', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1rem 2rem;
            width: 100%;
            font-size: 1.1rem;
        }

        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #5a67d8, #68d391);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Sample Prompts */
        .sample-prompts {
            margin-top: 2rem;
        }

        .sample-prompts h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: hsl(var(--foreground));
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sample-card {
            background: hsl(var(--muted));
            border: 1px solid hsl(var(--border));
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .sample-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .sample-card:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateX(4px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .sample-card:hover::before {
            left: 100%;
        }

        .sample-card-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .sample-card-text {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .sample-card-hint {
            font-size: 0.8rem;
            font-style: italic;
            opacity: 0.6;
        }

        /* Notice Card */
        .notice-card {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .notice-card h4 {
            color: #92400e;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Poppins', sans-serif;
        }

        .notice-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .notice-card li {
            padding: 0.25rem 0;
            position: relative;
            padding-left: 1.5rem;
            color: #92400e;
        }

        .notice-card li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #059669;
            font-weight: bold;
        }

        /* Results Section */
        .results-container {
            background: hsl(var(--card));
            border-radius: 20px;
            overflow: hidden;
            min-height: 600px;
            display: flex;
            flex-direction: column;
        }

        .results-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1.5rem 2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: 'Poppins', sans-serif;
        }

        .results-content {
            padding: 2rem;
            flex: 1;
            overflow-y: auto;
            max-height: 500px;
        }

        .placeholder {
            text-align: center;
            color: hsl(var(--muted-foreground));
            padding: 4rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .placeholder-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .placeholder h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: hsl(var(--foreground));
        }

        /* Log Items */
        .log-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            background: hsl(var(--muted));
            border-radius: 8px;
            color: hsl(var(--muted-foreground));
            animation: slideInLeft 0.4s ease-out;
            border-left: 3px solid #10b981;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .error-item {
            background: #fef2f2;
            border: 1px solid #fca5a5;
            border-left: 3px solid #ef4444;
            color: #dc2626;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Final Plan Styles */
        .final-plan {
            line-height: 1.8;
            color: hsl(var(--foreground));
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .final-plan h1, .final-plan h2, .final-plan h3 {
            color: #667eea;
            margin: 1.5rem 0 1rem 0;
            font-family: 'Poppins', sans-serif;
        }

        .final-plan h1 {
            font-size: 2rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }

        .final-plan h2 {
            font-size: 1.5rem;
        }

        .final-plan h3 {
            font-size: 1.25rem;
        }

        .final-plan p {
            margin-bottom: 1rem;
        }

        .final-plan ul, .final-plan ol {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        .final-plan li {
            margin-bottom: 0.5rem;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            z-index: 1000;
            color: hsl(var(--foreground));
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin-top: -2rem;
            }
            
            .card {
                padding: 1.5rem;
            }
            
            .container {
                padding: 0 1rem;
            }

            .hero-section {
                padding: 3rem 0 4rem;
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .card {
                padding: 1rem;
            }
            
            .card-header {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
            }
        }

        /* Utility Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        /* Enhanced Visual Effects */
        .glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }
    </style>
</head>

<body>
    <div class="theme-toggle" onclick="toggleTheme()">
        <i data-lucide="moon" id="theme-icon"></i>
    </div>

    <div class="hero-section">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">
                    <i data-lucide="plane" style="margin-right: 1rem;"></i>
                    AI Trip Planner
                </h1>
                <p class="hero-subtitle">
                    Craft the perfect journey with intelligent planning. Just describe your dream trip and let AI handle the rest.
                </p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-content">
            <!-- Left Column: Input Form -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i data-lucide="edit-3"></i>
                    </div>
                    <h2 class="card-title">Plan Your Trip</h2>
                </div>

                <form id="plannerForm">
                    <div class="form-group">
                        <label for="prompt" class="form-label">
                            <i data-lucide="lightbulb" style="margin-right: 0.5rem;"></i> 
                            Your Trip Prompt
                        </label>
                        <textarea 
                            id="prompt" 
                            class="form-textarea" 
                            placeholder="Describe your dream trip here... Include your origin, destination, dates, and interests!"
                            rows="6"
                        ></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <i data-lucide="send"></i>
                        Plan My Trip
                    </button>
                </form>

                <div class="sample-prompts">
                    <h3>
                        <i data-lucide="lightbulb"></i> 
                        Try a Sample Prompt
                    </h3>
                    
                    <div class="sample-card" onclick="setPrompt(this)">
                        <div class="sample-card-title">🏖️ Goa Beach & Temple Adventure</div>
                        <div class="sample-card-text">Plan a 7-day trip to Goa, India, from my home in Delhi, India. We want to leave on October 10th, 2025. We are interested in temples, beaches, and seafood. Please find flights and hotels. My email is hiteshofficial0001@gmail.com</div>
                        <div class="sample-card-hint">Perfect example with all required details</div>
                    </div>

                    <div class="sample-card" onclick="setPrompt(this)">
                        <div class="sample-card-title">🎨 Parisian Art & Cuisine Tour</div>
                        <div class="sample-card-text">Create a 5-day itinerary for a solo traveler in Paris, France from New York City for the first week of next April. Focus on art museums, historical landmarks, and authentic French cuisine. Find hotel options near the Louvre. Send plan to me@example.com</div>
                        <div class="sample-card-hint">Uses relative dates and specific interests</div>
                    </div>

                    <div class="sample-card" onclick="setPrompt(this)">
                        <div class="sample-card-title">🏔️ Swiss Alps Adventure</div>
                        <div class="sample-card-text">Plan a 10-day hiking and photography trip to the Swiss Alps from London, UK, departing June 15th, 2025. Looking for mountain lodges, scenic train routes, and hiking trails. Budget is around $3000. Email: adventure@example.com</div>
                        <div class="sample-card-hint">Includes budget and specific activities</div>
                    </div>
                </div>

                <div class="notice-card">
                    <h4>
                        <i data-lucide="info"></i>
                        For Best Results Include:
                    </h4>
                    <ul>
                        <li><strong>Origin:</strong> Where you're traveling from</li>
                        <li><strong>Destination:</strong> Where you want to go</li>
                        <li><strong>Dates:</strong> Specific departure/return dates</li>
                        <li><strong>Interests:</strong> What you want to do/see</li>
                        <li><strong>Email:</strong> To receive your itinerary (optional)</li>
                    </ul>
                    <small style="color: #92400e; font-style: italic; margin-top: 0.5rem; display: block;">
                        The AI works best with detailed, specific prompts. Vague requests may result in errors.
                    </small>
                </div>
            </div>

            <!-- Right Column: Results -->
            <div class="card results-container">
                <div class="results-header">
                    <i data-lucide="map-pin"></i>
                    Your Trip Plan
                </div>
                <div class="results-content">
                    <div id="logList"></div>
                    <div id="finalPlan" class="final-plan"></div>
                    <div id="placeholder" class="placeholder">
                        <div class="placeholder-icon">
                            <i data-lucide="route"></i>
                        </div>
                        <h3>Ready to Plan Your Adventure?</h3>
                        <p>Enter your trip details on the left and watch as AI crafts your perfect itinerary!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // API Configuration
        const API_URL = 'https://travel-agent-r8a6.onrender.com';

        // DOM Elements
        const plannerForm = document.getElementById('plannerForm');
        const promptInput = document.getElementById('prompt');
        const submitBtn = document.getElementById('submitBtn');
        const logList = document.getElementById('logList');
        const finalPlan = document.getElementById('finalPlan');
        const placeholder = document.getElementById('placeholder');

        // Theme Management
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeIcon.setAttribute('data-lucide', 'moon');
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                themeIcon.setAttribute('data-lucide', 'sun');
                localStorage.setItem('theme', 'dark');
            }
            
            // Reinitialize icons after changing
            lucide.createIcons();
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('theme-icon');
            
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeIcon.setAttribute('data-lucide', 'sun');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                themeIcon.setAttribute('data-lucide', 'moon');
            }
            
            lucide.createIcons();
        }

        // Set prompt from sample
        function setPrompt(element) {
            const promptText = element.querySelector('.sample-card-text').textContent;
            promptInput.value = promptText.trim();
            promptInput.focus();
            
            // Add visual feedback
            element.style.transform = 'scale(0.98)';
            setTimeout(() => {
                element.style.transform = '';
            }, 150);
        }

        // Handle form submission
        plannerForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            
            const prompt = promptInput.value.trim();
            if (!prompt) {
                showNotification('Please enter a trip prompt.', 'warning');
                return;
            }

            // Reset UI
            setLoadingState(true);
            clearResults();
            hideElement(placeholder);

            try {
                const response = await fetch(`${API_URL}/api/v1/plan-trip`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: prompt }),
                });

                if (!response.body) {
                    throw new Error('Response body is null.');
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;
                    
                    const chunk = decoder.decode(value, { stream: true });
                    const lines = chunk.split('\n\n');

                    lines.forEach(line => {
                        if (line.startsWith('data: ')) {
                            const data = line.substring(6);
                            try {
                                const message = JSON.parse(data);
                                handleStreamMessage(message);
                            } catch (e) {
                                console.error('Failed to parse JSON:', data);
                            }
                        }
                    });
                }

            } catch (error) {
                console.error('Fetch error:', error);
                showError(`Network error: ${error.message}`);
            } finally {
                setLoadingState(false);
            }
        });

        // Handle streaming messages
        function handleStreamMessage(message) {
            if (!message || !message.type) return;

            switch (message.type) {
                case 'log':
                    addLogMessage(message.content);
                    break;
                case 'result':
                    displayFinalPlan(message.content);
                    break;
                case 'error':
                    showError(message.content);
                    break;
            }
        }

        // UI Helper Functions
        function setLoadingState(isLoading) {
            if (isLoading) {
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<div class="spinner"></div> Planning Your Trip...';
                submitBtn.classList.add('pulse');
            } else {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i data-lucide="send"></i> Plan My Trip';
                submitBtn.classList.remove('pulse');
                lucide.createIcons();
            }
        }

        function clearResults() {
            logList.innerHTML = '';
            finalPlan.innerHTML = '';
        }

        function hideElement(element) {
            element.style.display = 'none';
        }

        function showElement(element) {
            element.style.display = 'block';
        }

        function addLogMessage(content) {
            const logElement = document.createElement('div');
            logElement.className = 'log-item';
            logElement.innerHTML = `
                <i data-lucide="check-circle" style="color: #10b981;"></i>
                <span>${content}</span>
            `;
            logList.appendChild(logElement);
            logList.scrollTop = logList.scrollHeight;
            lucide.createIcons();
        }

        function showError(content) {
            const errorElement = document.createElement('div');
            errorElement.className = 'error-item';
            errorElement.innerHTML = `
                <i data-lucide="alert-triangle" style="color: #ef4444; margin-right: 0.5rem;"></i>
                <strong>Error:</strong> ${content}
            `;
            logList.appendChild(errorElement);
            logList.scrollTop = logList.scrollHeight;
            lucide.createIcons();
        }

        function displayFinalPlan(content) {
            try {
                const htmlContent = marked.parse(content);
                finalPlan.innerHTML = htmlContent;
                finalPlan.classList.add('fade-in');
                
                // Smooth scroll to results
                finalPlan.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } catch (error) {
                console.error('Error parsing markdown:', error);
                finalPlan.textContent = content;
            }
        }

        function showNotification(message, type = 'info') {
            // Simple notification - enhanced with visual feedback
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'warning' ? '#f59e0b' : '#667eea'};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideInDown 0.3s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Enhanced animations and interactions
        function addInteractionEffects() {
            // Add floating animation to hero elements
            const heroTitle = document.querySelector('.hero-title');
            if (heroTitle) {
                heroTitle.addEventListener('mouseenter', () => {
                    heroTitle.style.transform = 'scale(1.05)';
                });
                
                heroTitle.addEventListener('mouseleave', () => {
                    heroTitle.style.transform = 'scale(1)';
                });
            }

            // Add focus effects to textarea
            promptInput.addEventListener('focus', () => {
                promptInput.parentElement.style.transform = 'scale(1.02)';
                promptInput.classList.add('glow');
            });
            
            promptInput.addEventListener('blur', () => {
                promptInput.parentElement.style.transform = 'scale(1)';
                promptInput.classList.remove('glow');
            });

            // Add intersection observer for scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);

            // Observe cards for scroll animations
            document.querySelectorAll('.card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
        }

        // Initialize the application
        function init() {
            loadTheme();
            addInteractionEffects();
            
            // Add welcoming animation
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease';
            
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);

            // Initialize all icons
            lucide.createIcons();
        }

        // Initialize when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        // Add some visual enhancements on scroll
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const heroSection = document.querySelector('.hero-section');
            if (heroSection) {
                heroSection.style.transform = `translateY(${scrolled * 0.5}px)`;
            }
        });
    </script>
</body>
</html>
